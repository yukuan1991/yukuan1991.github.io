<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Sponge的个人博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Sponge的个人博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sponge的个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Sponge的个人博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Sponge的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/11/18/可视化大屏动效/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/11/18/可视化大屏动效/" itemprop="url">可视化大屏动效</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-11-18T16:07:52+08:00">
                2021-11-18
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2021/11/18/可视化大屏动效/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2021/11/18/可视化大屏动效/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>本文主要针对在日常大屏项目跟进过程中使用到的动效做一些总结。</p>
<h2 id="进场效果"><a href="#进场效果" class="headerlink" title="进场效果"></a>进场效果</h2><h3 id="1、animate-css"><a href="#1、animate-css" class="headerlink" title="1、animate.css"></a>1、animate.css</h3><p>进场效果我推荐使用animate.css，它有如下几个特点:</p>
<ul>
<li>开源免费 - 基于MIT开源协议，被授权人有权利使用、复制、修改、合并、出版发行、散布、再授权及贩售软件及软件的副本。</li>
<li>使用简单 - 只有一个CSS文件，引入后以类的方式进行调用，如果使用jquery，则不影响原有程序架构</li>
<li>文件小，响应快 - 体积小巧，只有几十k的大小，响应速度非常快</li>
</ul>
<p>用法：</p>
<p><code>html</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;!-- 引入css --&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;&apos;css/animate.min.css&apos;&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;con-l&quot;&gt;</span><br><span class="line">            &lt;!-- 使用对应类名 --&gt;</span><br><span class="line">            &lt;div class=&quot;box box1 animate__animated animate__bounceInLeft&quot;&gt;&lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;box box2 animate__animated animate__bounceInLeft&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>还可通过css设置动画的延时属性，使得模块依次进场：</p>
<p><code>scss</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.con-l &#123;</span><br><span class="line">    .box2 &#123;</span><br><span class="line">        animation-delay: 300ms;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/18/可视化大屏动效/animate.gif" alt="animate.gif"></p>
<h3 id="2、GSAP-GreenSock-Animation-Platform"><a href="#2、GSAP-GreenSock-Animation-Platform" class="headerlink" title="2、GSAP-GreenSock Animation Platform"></a>2、GSAP-GreenSock Animation Platform</h3><p>在网页上创建动画，我们会很快想到 <code>jQuery</code>的 <code>animate()</code> 方法，或者是 <code>css3</code>的 <code>animation</code> 和 <code>transition</code> 属性。而今天主要介绍另一个web动画的可选方法：GSAP。</p>
<p><code>GSAP</code>是在Flash动画时代就存在的 <code>Javascript</code> 动画库,它具有如下几个优点：</p>
<ul>
<li>速度快。GSAP专门优化了动画性能，使之实现和CSS一样的高性能动画效果。</li>
<li>轻量与模块化。模块化与插件式的结构保持了核心引擎的轻量，TweenLite包非常小（基本上低于7kb）。GSAP提供了 <code>TweenLite</code> , <code>TimelineLite</code> , <code>TimelineMax</code> 和 <code>TweenMax</code> 不同功能的动画模块，你可以按需使用。</li>
<li>没有依赖。</li>
<li>灵活控制。不用受限于线性序列，可以重叠动画序列，你可以通过精确时间控制，灵活地使用最少的代码实现动画。</li>
<li>任何对象都可以实现动画。</li>
</ul>
<p><img src="/2021/11/18/可视化大屏动效/gsap_general.png" alt="gsap_general.png"></p>
<p>在开始前准备一些基本代码，如下所示：</p>
<p><code>html</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;box&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p><code>css</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">  background-color: #262626;</span><br><span class="line">  font-family: &apos;Open Sans&apos;, sans-serif;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">#box &#123;</span><br><span class="line">  background-color: #88ce02;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 50%;</span><br><span class="line">  left: 50%;</span><br><span class="line">  width: 100px;</span><br><span class="line">  height: 100px;</span><br><span class="line">  transform: translate(-50%, -50%);</span><br><span class="line">  z-index: 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="TweenLite-to-方法"><a href="#TweenLite-to-方法" class="headerlink" title="TweenLite.to() 方法"></a><code>TweenLite.to()</code> 方法</h4><p>这个方法可以定义元素的结束状态，从而实现css设置的样式到定义的状态的动画过渡。</p>
<p>下图为 <code>TweenLite.to()</code> 方法的示意图：</p>
<p><img src="/2021/11/18/可视化大屏动效/gsap_to.png" alt="gsap_to.png"></p>
<p>在 <code>js</code> 中运行如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TweenLite.to($box, 0.7, &#123;left: 0&#125;);</span><br></pre></td></tr></table></figure>
<p>在浏览器中，会看到在0.7秒之内把$box元素从CSS中定义的位置移动到body的左侧边缘。</p>
<p><img src="/2021/11/18/可视化大屏动效/gsap_to.gif" alt="gsap_to.gif"></p>
<h4 id="TweenLite-from-方法"><a href="#TweenLite-from-方法" class="headerlink" title="TweenLite.from() 方法"></a><code>TweenLite.from()</code> 方法</h4><p>这个方法是用来使元素从定义在.from()方法里的位置运动到在CSS中定义的位置。</p>
<p>在 <code>js</code> 中运行如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TweenLite.from($box, 2, &#123;x: &apos;-=200px&apos;, autoAlpha: 0&#125;);</span><br></pre></td></tr></table></figure>
<p>运行这个例子，我们会看到元素从元素左边200px的位置运动到元素在CSS中定义的位置。<br>autoAlpha方法是GSAP中一个特别的属性，它把opacity和visibility两个属性合二为一了。</p>
<p><img src="/2021/11/18/可视化大屏动效/gsap_autoAlpha.png" alt="gsap_autoAlpha.png"></p>
<h4 id="TweenLite-set-方法"><a href="#TweenLite-set-方法" class="headerlink" title="TweenLite.set() 方法"></a><code>TweenLite.set()</code> 方法</h4><p>如果只是想设置元素的一些CSS属性并不需要动画效果，比如，重设元素的位置。</p>
<p>这个时候就可以使用GreenSock提供的.set()方法。</p>
<h4 id="TweenLite-fromTo-方法"><a href="#TweenLite-fromTo-方法" class="headerlink" title="TweenLite.fromTo() 方法"></a><code>TweenLite.fromTo()</code> 方法</h4><p>这个方法可以定义元素的起始位置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TweenLite.fromTo($box, 2, &#123;x: &apos;-=200px&apos;&#125;, &#123;x: 150&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/18/可视化大屏动效/gsap_fromTo.png" alt="gsap_fromTo.png"></p>
<p>下面不妨让我们来看看它在实际项目中的表现吧。</p>
<p><img src="/2021/11/18/可视化大屏动效/gsap_project.gif" alt="gsap_project.gif"></p>
<p>显然它的功能不止于此，还有许多api可供大家选择使用。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://www.animate.net.cn/" target="_blank" rel="noopener">Animate中文网</a></p>
<p><a href="https://greensock.com/docs/" target="_blank" rel="noopener">GreenSock官方文档</a></p>
<p><a href="https://www.tweenmax.com.cn/index.html" target="_blank" rel="noopener">TweenMax中文网</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/26/基于WASM的H265-Web播放器/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/07/26/基于WASM的H265-Web播放器/" itemprop="url">基于WASM的H265 Web播放器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-07-26T09:40:30+08:00">
                2021-07-26
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2021/07/26/基于WASM的H265-Web播放器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2021/07/26/基于WASM的H265-Web播放器/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  558
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>在张家港IOC项目中，页面需要接入监控视频，由于之前并没有实际接触过此类需求，首先参考了之前一些项目的案例，并与后端沟通后，确定提供的是 <code>HLS</code> 流，使用 <code>video.js</code> 进行对接。但实际对接中，发现很多视频都是 <code>H265</code> 编码格式的，浏览器的播放器并不支持。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="1-监控厂商提供辅码流"><a href="#1-监控厂商提供辅码流" class="headerlink" title="1 监控厂商提供辅码流"></a>1 监控厂商提供辅码流</h3><p>监控厂商提供的 <code>api</code> 中可以配置辅码流即 <code>H264</code> 编码格式。</p>
<h3 id="2-使用基于WASM的H265-Web播放器"><a href="#2-使用基于WASM的H265-Web播放器" class="headerlink" title="2 使用基于WASM的H265 Web播放器"></a>2 使用基于WASM的H265 Web播放器</h3><p>经过查阅资料，发现了 1 款这样的播放器，下面就来看看吧：</p>
<h4 id="Easyplay-js"><a href="#Easyplay-js" class="headerlink" title="Easyplay.js"></a>Easyplay.js</h4><p> <code>EasyPlayer.js H5</code> 播放器，是一款能够同时支持 <code>HTTP、HTTP-FLV、HLS（m3u8）、WS</code> 视频直播与视频点播等多种协议，支持 <code>H.264、H.265、AAC</code> 等多种音视频编码格式，支持mse、wasm等多种解码方式，支持 <code>Windows、Linux、Android、iOS</code> 全平台终端的H5播放器，使用简单, 功能强大。</p>
<p> <code>HTML</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;easyplayer&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot; /&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot; /&gt;</span><br><span class="line">    &lt;meta</span><br><span class="line">      content=&quot;width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no&quot;</span><br><span class="line">      name=&quot;viewport&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;EasyPlayer-element.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;easy-player</span><br><span class="line">      video-url=&quot;rtmp://live.hkstv.hk.lxdns.com/live/hks2&quot;</span><br><span class="line">      live=&quot;true&quot;</span><br><span class="line">      stretch=&quot;true&quot;</span><br><span class="line">    &gt;&lt;/easy-player&gt;</span><br><span class="line">    &lt;easy-player</span><br><span class="line">      video-url=&quot;http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8&quot;</span><br><span class="line">      live=&quot;false&quot;</span><br><span class="line">      stretch=&quot;true&quot;</span><br><span class="line">    &gt;&lt;/easy-player&gt;</span><br><span class="line">    &lt;easy-player</span><br><span class="line">      video-url=&quot;http://live.hkstv.hk.lxdns.com/flv/hks.flv&quot;</span><br><span class="line">      live=&quot;true&quot;</span><br><span class="line">      stretch=&quot;true&quot;</span><br><span class="line">    &gt;&lt;/easy-player&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>引用对应资源后，只需要将对应的播放地址在 <code>easy-player</code> 元素标签上配置一下即可，非常简单便捷。</p>
<p>需要注意的是：<br>（1）<code>libDecoder.wasm</code> 需要放在文件夹最外层目录下，否则找不到该资源。<br>（2）目前该方案在与睿呈三维配套使用时，存在问题。</p>
<p><img src="/2021/07/26/基于WASM的H265-Web播放器/error.png" alt="error.png"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://192.168.219.170/fetc/article/224.html" target="_blank" rel="noopener">两种常见视频流对接方案</a></p>
<p><a href="https://oa.epoint.com.cn/EpointCommunity/EpointCommunity/Dis/ShowTopic.aspx?TopicID=25980" target="_blank" rel="noopener">视频对接方案</a></p>
<p><a href="https://github.com/tsingsee/EasyPlayer.js" target="_blank" rel="noopener">EasyPlayer.js</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/06/03/Vue封装echarts地图组件/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/06/03/Vue封装echarts地图组件/" itemprop="url">Vue封装echarts地图组件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-06-03T10:28:44+08:00">
                2021-06-03
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2021/06/03/Vue封装echarts地图组件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2021/06/03/Vue封装echarts地图组件/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  530
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><p>大屏项目中总会用到各式各样的地图，其中最常用的就是 <code>echarts</code> 的地图。近期参与了使用 <code>Vue-Cli</code> 的项目，由于多个主题都会使用到地图，那么封装一个地图组件就非常有必要了。下面就跟大家分享一下：</p>
<p><img src="/2021/06/03/Vue封装echarts地图组件/map1.png" alt="map1.png"></p>
<h2 id="安装echarts"><a href="#安装echarts" class="headerlink" title="安装echarts"></a>安装echarts</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 执行命令安装</span><br><span class="line">npm install echarts --save-dev</span><br></pre></td></tr></table></figure>
<h2 id="建立地图组件"><a href="#建立地图组件" class="headerlink" title="建立地图组件"></a>建立地图组件</h2><p>组件中仅展示了最基础的一些配置，可根据实际需求进行个性化。</p>
<p><code>vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div id=&quot;chart-map&quot; ref=&quot;map&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 资源引入</span><br><span class="line">import * as echarts from &apos;echarts&apos;; // echarts</span><br><span class="line">import &apos;./js/shangluo.js&apos;; // 地图js</span><br><span class="line">import Util from &apos;../../util/util&apos;; // 工具方法</span><br><span class="line">// 引入图片资源方式一</span><br><span class="line">// import Scatter from &apos;./images/scatter.png&apos;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    name: &apos;slmap&apos;,</span><br><span class="line">    // 配置需要的props</span><br><span class="line">    props: &#123;</span><br><span class="line">        // 地图数据</span><br><span class="line">        data: &#123;</span><br><span class="line">            type: Array,</span><br><span class="line">            default: function () &#123;</span><br><span class="line">                return [];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 地图配置</span><br><span class="line">        options: &#123;</span><br><span class="line">            type: Object,</span><br><span class="line">            default() &#123;</span><br><span class="line">                return &#123;&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            chart: null</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted() &#123;</span><br><span class="line">        // 初始化echarts地图实例</span><br><span class="line">        this.chart = echarts.init(this.$refs.map);</span><br><span class="line">        // 渲染地图</span><br><span class="line">        this.renderMap();</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeDestroy() &#123;</span><br><span class="line">        // 销毁</span><br><span class="line">        this.chart &amp;&amp; this.chart.dispose();</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        // 渲染地图</span><br><span class="line">        renderMap() &#123;</span><br><span class="line">            // 地图图表配置信息</span><br><span class="line">            var chartOptions = &#123;</span><br><span class="line">                series: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        type: &apos;map&apos;,</span><br><span class="line">                        left: 30,</span><br><span class="line">                        right: 30,</span><br><span class="line">                        top: 20,</span><br><span class="line">                        bottom: 90,</span><br><span class="line">                        map: &apos;shangluo&apos;,</span><br><span class="line">                        selectedMode: &apos;single&apos;,</span><br><span class="line">                        label: &#123;</span><br><span class="line">                            show: true,</span><br><span class="line">                            color: &apos;#fff&apos;,</span><br><span class="line">                            fontSize: 14</span><br><span class="line">                        &#125;,</span><br><span class="line">                        itemStyle: &#123;</span><br><span class="line">                            borderColor: &apos;#36EAFF&apos;,</span><br><span class="line">                            borderWidth: 2</span><br><span class="line">                        &#125;,</span><br><span class="line">                        emphasis: &#123;</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                color: &apos;#fff&apos;,</span><br><span class="line">                                fontSize: 14,</span><br><span class="line">                                formatter: &apos;&#123;site|&#125;\n&#123;b&#125;&apos;,</span><br><span class="line">                                rich: &#123;</span><br><span class="line">                                    site: &#123;</span><br><span class="line">                                        width: 38,</span><br><span class="line">                                        height: 39,</span><br><span class="line">                                        backgroundColor: &#123;</span><br><span class="line">                                            // image: Scatter,</span><br><span class="line">                                            // 引入图片资源方式二</span><br><span class="line">                                            image: require(&apos;./images/scatter.png&apos;)</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            itemStyle: &#123;</span><br><span class="line">                                areaColor: &apos;#FFBD30&apos;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        data: this.data</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;;</span><br><span class="line">            this.chart.setOption(Object.assign(chartOptions, this.options));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">#chart-map &#123;</span><br><span class="line">    // 地图相关样式</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h2 id="引用图片资源"><a href="#引用图片资源" class="headerlink" title="引用图片资源"></a>引用图片资源</h2><p>需要注意的是，在常规模式下，使用图片资源只需要引用图片的相对路径就行，但在 <code>vue</code> 组件中则需要通过 <code>import</code> 或者 <code>require</code> 的方式去进行引用资源，个人推荐使用 <code>require</code> 的方式去引用。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/10/Swiper的常见用法及场景/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/10/Swiper的常见用法及场景/" itemprop="url">轻松搞定Swiper轮播</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-10T10:14:57+08:00">
                2020-09-10
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/09/10/Swiper的常见用法及场景/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/09/10/Swiper的常见用法及场景/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.9k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><p><code>Swiper</code>(Swiper master)是目前应用较广泛的移动端网页触摸内容滑动js插件，简单配置即可实现手机、电脑网页大部分滑动功能，焦点图、tab、触摸导航等。</p>
<p>大屏开发中也经常用到例如轮播图片、信息列表等。相比于<code>scrollbox</code>，<code>swiper</code>支持手动拖拽、点击切换，用户体验更佳。</p>
<h2 id="常规用法"><a href="#常规用法" class="headerlink" title="常规用法"></a>常规用法</h2><p>首先对应的引入<code>swiper</code>的<code>js</code>、<code>css</code>资源，根据对应的需求编写<code>dom</code>、<code>css</code>样式，最后<code>js</code>简单配置一下，就完成了一个简单的轮播功能。</p>
<p><code>HTML</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;swiper-container&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;swiper-wrapper&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;swiper-slide&quot;&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;swiper-slide&quot;&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;swiper-slide&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/swiper-container&gt;</span><br></pre></td></tr></table></figure></p>
<p><code>JS</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var swiperObj = new Swiper(&apos;.swiper-container&apos;, &#123;</span><br><span class="line">    direction: &apos;vertical&apos;, // Swiper的滑动方向,默认为horizontal（水平方向）</span><br><span class="line">    slidesPerView: &apos;auto&apos;, // 设置slider容器能够同时显示的slides数量</span><br><span class="line">    autoplay: &#123;</span><br><span class="line">        delay: 3000, // 轮播时间</span><br><span class="line">        disableOnInteraction: false // 用户操作swiper之后，是否禁止autoplay。默认为true：停止。</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="实际项目分享"><a href="#实际项目分享" class="headerlink" title="实际项目分享"></a>实际项目分享</h2><p>简单的轮播相信大家都会，下面就跟大家分享一下我实际项目中做过的<code>swiper</code>实例吧。</p>
<h3 id="swiper切换效果一-嵌套"><a href="#swiper切换效果一-嵌套" class="headerlink" title="swiper切换效果一+嵌套"></a>swiper切换效果一+嵌套</h3><p><img src="/2020/09/10/Swiper的常见用法及场景/swiper1.gif" alt="swiper1.gif"></p>
<p>最外层的<code>swiper</code>使用了切换效果的配置，配置如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// 初始化top10类别swiper</span><br><span class="line">    var categorySwiper = new Swiper(&apos;.category-swiper-container&apos;, &#123;</span><br><span class="line">        slidesPerView: &apos;auto&apos;,</span><br><span class="line">        autoplay: &#123;</span><br><span class="line">            delay: 10000,</span><br><span class="line">            disableOnInteraction: false,</span><br><span class="line">        &#125;,</span><br><span class="line">        centeredSlides: true, // 设定为true时，active slide会居中，而不是默认状态下的居左。</span><br><span class="line">        slideToClickedSlide: true, // 设置为true则点击slide会过渡到这个slide。</span><br><span class="line">        /* 切换效果 */</span><br><span class="line">        effect: &apos;coverflow&apos;, // cover flow是类似于苹果将多首歌曲的封面以3D界面的形式显示出来的方式。</span><br><span class="line">        coverflowEffect: &#123;</span><br><span class="line">            rotate: -45, // slide做3d旋转时Y轴的旋转角度</span><br><span class="line">            stretch: 40, // 每个slide之间的拉伸值，越大slide靠得越紧</span><br><span class="line">            depth: 800, // slide的位置深度。值越大z轴距离越远，看起来越小</span><br><span class="line">            modifier: 1, // depth和rotate和stretch的倍率</span><br><span class="line">            slideShadows: true // 是否开启slide阴影</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>top10列表配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// 初始化top10列表swiper</span><br><span class="line">    var top10Swiper = new Swiper(&apos;.top10-swiper&apos; + i, &#123;</span><br><span class="line">        direction: &apos;vertical&apos;,</span><br><span class="line">        slidesPerView: &apos;auto&apos;,</span><br><span class="line">        slideToClickedSlide: true,</span><br><span class="line">        centeredSlides: true,</span><br><span class="line">        loop: true, // 设置为true 则开启loop模式。</span><br><span class="line">        effect: &apos;coverflow&apos;,</span><br><span class="line">        coverflowEffect: &#123;</span><br><span class="line">            rotate: 0,</span><br><span class="line">            stretch: -30,</span><br><span class="line">            depth: 100,</span><br><span class="line">            modifier: 1,</span><br><span class="line">            slideShadows: false</span><br><span class="line">        &#125;,</span><br><span class="line">        on: &#123;</span><br><span class="line">            // 回调函数，过渡结束时触发，监听列表项变化，联动模块刷新</span><br><span class="line">            transitionEnd: function () &#123;</span><br><span class="line">                var idx = this.realIndex;</span><br><span class="line">                renderDetail(datas[i][idx].detail, i);</span><br><span class="line">                $(&apos;.total-number&gt;span&apos;).text(datas[i][idx].total);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>列表详情配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 列表详情</span><br><span class="line">detailSwiperArr[index] = new Swiper(&apos;.detail-swiper&apos; + index, &#123;</span><br><span class="line">    slideToClickedSlide: true,</span><br><span class="line">    nested: true, // 关键属性：用于嵌套相同方向的swiper时，当切换到子swiper时停止父swiper的切换。</span><br><span class="line">    // 分页配置</span><br><span class="line">    pagination: &#123;</span><br><span class="line">        el: &apos;.detail-pagination&apos; + index,</span><br><span class="line">        clickable: true // 是否可点击</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="swiper切换效果二"><a href="#swiper切换效果二" class="headerlink" title="swiper切换效果二"></a>swiper切换效果二</h3><p><img src="/2020/09/10/Swiper的常见用法及场景/swiper2.gif" alt="swiper2.gif"></p>
<p>这个效果主要是中间要展示两个对应的滑块，我这边的方案就是把每个对应的<code>slide</code>里都放入 2 个对应的模块，然后通过<code>swiper-container</code>容器宽度超出时，将对应左右两边的 1 个模块通过<code>overflow:hidden</code>隐藏。</p>
<p><code>html</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// dom</span><br><span class="line">&lt;div class=&quot;swiper-container&quot; id=&quot;punishment-ct&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;swiper-wrapper&quot; id=&quot;punishment-bd&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">// 模板</span><br><span class="line">&lt;!-- 行政处罚情况 --&gt;</span><br><span class="line">&lt;script type=&quot;text/html&quot; id=&quot;punishment-tpl&quot;&gt;</span><br><span class="line">    &#123;&#123;#.&#125;&#125;</span><br><span class="line">      // 对应模板内容</span><br><span class="line">    &#123;&#123;/.&#125;&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><code>js</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">// 渲染轮播列表(工具方法)</span><br><span class="line">function renderList(data, swiperobj, options) &#123;</span><br><span class="line">    // 生成序号</span><br><span class="line">	$.each(data, function (i, e) &#123;</span><br><span class="line">		e.order = i + 1;</span><br><span class="line">	&#125;);</span><br><span class="line">    // 销毁</span><br><span class="line">	swiperobj &amp;&amp; swiperobj.destroy();</span><br><span class="line">	swiperobj = null;</span><br><span class="line">    // 生成dom</span><br><span class="line">	Util.renderer((options.tpl || options.key) + &apos;-tpl&apos;, data).to(options.key + &apos;-bd&apos;);</span><br><span class="line">    // 默认配置</span><br><span class="line">	var defaultOpt = &#123;</span><br><span class="line">		direction: &apos;vertical&apos;,</span><br><span class="line">		slidesPerView: 5,</span><br><span class="line">		autoplay: &#123;</span><br><span class="line">			delay: 3000,</span><br><span class="line">			disableOnInteraction: false</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	swiperobj = new Swiper(&apos;#&apos; + options.key + &apos;-ct&apos;, Object.assign(defaultOpt, options));</span><br><span class="line">	return swiperobj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 行政处罚情况</span><br><span class="line">function getPenalties(data) &#123;</span><br><span class="line">    // 处理数据格式 一维数组 =&gt; 二维数组</span><br><span class="line">    // [&#123;name: &apos;xx&apos;&#125;,&#123;name: &apos;xx&apos;&#125;,...] =&gt; [[&#123;name: &apos;xx&apos;&#125;,&#123;name: &apos;xx&apos;&#125;], []...]</span><br><span class="line">	var datas = Util.splitArr(data, 2);</span><br><span class="line">	punishmentSwiper = renderList(datas, punishmentSwiper, &#123;</span><br><span class="line">		key: &apos;punishment&apos;, // 关键词,对应dom id前缀</span><br><span class="line">        // tpl: &apos;&apos;, // 模板对应关键词，当多个swiper共用一个模板时需要设置，默认使用key的值</span><br><span class="line">        /* 自定义配置项与默认配置混合 */</span><br><span class="line">		direction: &apos;horizontal&apos;,</span><br><span class="line">		loop: true,</span><br><span class="line">		effect: &apos;coverflow&apos;,</span><br><span class="line">		slidesPerView: &apos;auto&apos;,</span><br><span class="line">		coverflowEffect: &#123;</span><br><span class="line">			rotate: 0,</span><br><span class="line">			stretch: 0,</span><br><span class="line">			depth: 500,</span><br><span class="line">			slideShadows: false</span><br><span class="line">		&#125;,</span><br><span class="line">		centeredSlides: true</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="swiper缩放"><a href="#swiper缩放" class="headerlink" title="swiper缩放"></a>swiper缩放</h3><p><img src="/2020/09/10/Swiper的常见用法及场景/swiper3.gif" alt="swiper3.gif"></p>
<p>该效果主要通过每个<code>slide</code>对应的progress值，去动态计算出一个基值，从而产生不同的偏移距离、缩放比例等。</p>
<p><code>js</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">var swiper = new Swiper(&apos;.swiper-container&apos;, &#123;</span><br><span class="line">    watchSlidesProgress: true, // 开启这个参数来计算每个slide的progress，Swiper的progress无需设置即开启。</span><br><span class="line">    slidesPerView: &apos;auto&apos;,</span><br><span class="line">    centeredSlides: true,</span><br><span class="line">    loop: true,</span><br><span class="line">    autoplay: &#123;</span><br><span class="line">        disableOnInteraction: false</span><br><span class="line">    &#125;,</span><br><span class="line">    on: &#123;</span><br><span class="line">        progress: function () &#123;</span><br><span class="line">            for (var i = 0; i &lt; this.slides.length; i++) &#123;</span><br><span class="line">                var slide = this.slides.eq(i);</span><br><span class="line">                var slideProgress = this.slides[i].progress; // 每个slide的progress</span><br><span class="line">                var modify = 1; // 默认基数</span><br><span class="line">                if (Math.abs(slideProgress) &gt; 1) &#123;</span><br><span class="line">                    modify = (Math.abs(slideProgress) - 1) * 0.3 + 1; // 动态计算基数</span><br><span class="line">                &#125;</span><br><span class="line">                var translate = slideProgress * modify * 530 + &apos;px&apos;; // 偏移距离</span><br><span class="line">                var scale = 1 - Math.abs(slideProgress) / 3; // 缩放比例</span><br><span class="line">                var zIndex = 999 - Math.abs(Math.round(10 * slideProgress)); // z值</span><br><span class="line">                slide.transform(&apos;translateX(&apos; + translate + &apos;) scale(&apos; + scale + &apos;)&apos;);</span><br><span class="line">                slide.css(&apos;zIndex&apos;, zIndex);</span><br><span class="line">                slide.css(&apos;opacity&apos;, 1);</span><br><span class="line">                // 隐藏其它slide</span><br><span class="line">                if (Math.abs(slideProgress) &gt; 3) &#123;</span><br><span class="line">                    slide.css(&apos;opacity&apos;, 0);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 设置对应slide的偏移距离</span><br><span class="line">        setTransition: function (transition) &#123;</span><br><span class="line">            for (var i = 0; i &lt; this.slides.length; i++) &#123;</span><br><span class="line">                var slide = this.slides.eq(i);</span><br><span class="line">                slide.transition(transition);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="swiper-transition效果一"><a href="#swiper-transition效果一" class="headerlink" title="swiper transition效果一"></a>swiper transition效果一</h3><p><img src="/2020/09/10/Swiper的常见用法及场景/swiper4.gif" alt="swiper4.gif"></p>
<p>该效果主要难点在于<code>slide</code>的激活状态与常态的宽高不一致，而<code>swiper</code>每次滑动距离都是固定的。主要的解决思路就是<code>swiper</code>每次滑动是通过改变<code>swiper-wrapper</code>的<code>translate</code>属性，那么我们可以通过<code>js</code>在每次切换时，给它固定好移动的距离，就可以了，还有一个需要注意的点就是<code>slide</code>的大小会平均分配，在<code>css</code>中需要将对应的状态的<code>slide</code>设置固定宽高。</p>
<p><code>JS</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var mySwiper = new Swiper(&apos;.swiper-container&apos;, &#123;</span><br><span class="line">    slidesPerView: 5,</span><br><span class="line">    centeredSlides: true,</span><br><span class="line">    spaceBetween: 100, // 间隔</span><br><span class="line">    slideToClickedSlide: true,</span><br><span class="line">    autoplay: &#123;</span><br><span class="line">        delay: 3000,</span><br><span class="line">        disableOnInteraction: false</span><br><span class="line">    &#125;,</span><br><span class="line">    on: &#123;</span><br><span class="line">        // 关键步骤 过渡开始前，设置对应的translate</span><br><span class="line">        transitionStart: function () &#123;</span><br><span class="line">            var _this = this;</span><br><span class="line">            // 返回第一个</span><br><span class="line">            if (this.isEnd) &#123;</span><br><span class="line">                setTimeout(function () &#123;</span><br><span class="line">                    _this.slideTo(0);</span><br><span class="line">                &#125;, 3000);</span><br><span class="line">            &#125;</span><br><span class="line">            var translate = 3810 - this.realIndex * 1905; // 3810为初始位置的偏移, 1905为单个轮播的偏移</span><br><span class="line">            this.setTranslate(translate);</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="swiper-transition效果二"><a href="#swiper-transition效果二" class="headerlink" title="swiper transition效果二"></a>swiper transition效果二</h3><p><img src="/2020/09/10/Swiper的常见用法及场景/swiper5.gif" alt="swiper5.gif"></p>
<p>这个其实和上一个例子配置上差别不大，区别就是起始位置一个在中间，一个则是在顶部。这个里面并没有使用<code>autoplay</code>，因为当<code>swiper</code>能把最后的<code>slide</code>展示出来的时候，它并不会继续轮播下去直至最后一个<code>slide</code>高亮，而会直接从头开始。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var reportSwiper = new Swiper(&apos;#report-container&apos;, &#123;</span><br><span class="line">    direction: &apos;vertical&apos;,</span><br><span class="line">    slidesPerView: &apos;auto&apos;,</span><br><span class="line">    spaceBetween: 10,</span><br><span class="line">    centeredSlides: true,</span><br><span class="line">    slideToClickedSlide: true,</span><br><span class="line">    on: &#123;</span><br><span class="line">      transitionStart: function () &#123;</span><br><span class="line">        clearTimeout(reportTimer);</span><br><span class="line">        var _this = this;</span><br><span class="line">        var next;</span><br><span class="line">        if (this.isEnd) &#123;</span><br><span class="line">          next = 0;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          next = this.realIndex + 1;</span><br><span class="line">        &#125;</span><br><span class="line">        reportTimer = setTimeout(function () &#123;</span><br><span class="line">          _this.slideTo(next);</span><br><span class="line">        &#125;, 3000);</span><br><span class="line">        var translate = -this.realIndex * 52;</span><br><span class="line">        this.setTranslate(translate);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="swiper-rem方案"><a href="#swiper-rem方案" class="headerlink" title="swiper rem方案"></a>swiper rem方案</h3><p><img src="/2020/09/10/Swiper的常见用法及场景/swiper6.gif" alt="swiper6.gif"></p>
<p>之前做自适应页面的时候，估计大家也都碰到过页面手动缩放时<code>swiper</code>样式错乱的问题，解决方案就是监听它的<code>resize</code>事件，然后调用<code>update</code>方法去更新。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">areaSwiper = renderSwiper(data, areaSwiper, &#123;</span><br><span class="line">    key: &apos;area&apos;,</span><br><span class="line">    effect: &apos;coverflow&apos;,</span><br><span class="line">    centeredSlides: true,</span><br><span class="line">    loop: true,</span><br><span class="line">    coverflowEffect: &#123;</span><br><span class="line">        rotate: -30,</span><br><span class="line">        stretch: -20,</span><br><span class="line">        depth: 100,</span><br><span class="line">        modifier: 1,</span><br><span class="line">        slideShadows: false</span><br><span class="line">    &#125;,</span><br><span class="line">    on: &#123;</span><br><span class="line">        // 关键步骤监听resize事件，更新swiper</span><br><span class="line">        resize: function () &#123;</span><br><span class="line">            setTimeout(() =&gt; &#123;</span><br><span class="line">                areaSwiper.update();</span><br><span class="line">            &#125;, 100);   //延时器很重要，不加可能会出错</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>以上就是我对于<code>swiper</code>的一些理解与运用，希望能对大家有所帮助。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/23/Vuex/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/23/Vuex/" itemprop="url">Vuex</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-23T09:22:11+08:00">
                2019-04-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/04/23/Vuex/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/04/23/Vuex/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.6k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Vuex是什么？"><a href="#Vuex是什么？" class="headerlink" title="Vuex是什么？"></a>Vuex是什么？</h1><p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p>
<h1 id="什么是“状态管理模式”？"><a href="#什么是“状态管理模式”？" class="headerlink" title="什么是“状态管理模式”？"></a>什么是“状态管理模式”？</h1><p>一个简单的Vue计数应用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">new Vue(&#123;</span><br><span class="line">  // state</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      count: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  // view</span><br><span class="line">  template: `</span><br><span class="line">    &lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;</span><br><span class="line">  `,</span><br><span class="line">  // actions</span><br><span class="line">  methods: &#123;</span><br><span class="line">    increment () &#123;</span><br><span class="line">      this.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>这个状态自管理应用包含以下几个部分：</p>
<ul>
<li>state，驱动应用的数据源；</li>
<li>view，以声明方式将 state 映射到视图；</li>
<li>actions，响应在 view 上的用户输入导致的状态变化。</li>
</ul>
<p>以下是一个表示“单向数据流”理念的简单示意：<br><img src="/2019/04/23/Vuex/flow.png" alt="单向数据流"></p>
<p>但是，当我们的应用遇到多个组件共享状态时，单向数据流的简洁性很容易被破坏：</p>
<ul>
<li>多个视图依赖于同一状态。</li>
<li>来自不同视图的行为需要变更同一状态。</li>
</ul>
<p>对于问题一，传参的方法对于多层嵌套的组件将会非常繁琐，并且对于兄弟组件间的状态传递无能为力。</p>
<p>对于问题二，我们经常会采用父子组件直接引用或者通过事件来变更和同步状态的多份拷贝。以上的这些模式非常脆弱，通常会导致无法维护的代码。</p>
<h1 id="什么情况下应该使用Vuex"><a href="#什么情况下应该使用Vuex" class="headerlink" title="什么情况下应该使用Vuex?"></a>什么情况下应该使用Vuex?</h1><p>如果不打算开发中大型单页应用，一个简单的store模式就足够了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var store = &#123;</span><br><span class="line">  debug: true,</span><br><span class="line">  state: &#123;</span><br><span class="line">    message: &apos;Hello!&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  setMessageAction (newValue) &#123;</span><br><span class="line">    if (this.debug) console.log(&apos;setMessageAction triggered with&apos;, newValue)</span><br><span class="line">    this.state.message = newValue</span><br><span class="line">  &#125;,</span><br><span class="line">  clearMessageAction () &#123;</span><br><span class="line">    if (this.debug) console.log(&apos;clearMessageAction triggered&apos;)</span><br><span class="line">    this.state.message = &apos;&apos;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>需要注意，所有 store 中 state 的改变，都放置在 store 自身的 action 中去管理。这种集中式状态管理能够被更容易地理解哪种类型的 mutation 将会发生，以及它们是如何被触发。当错误出现时，我们现在也会有一个 log 记录 bug 之前发生了什么。</p>
<p>此外，每个实例/组件仍然可以拥有和管理自己的私有状态：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var vmA = new Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    privateState: &#123;&#125;,</span><br><span class="line">    sharedState: store.state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">var vmB = new Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    privateState: &#123;&#125;,</span><br><span class="line">    sharedState: store.state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h1 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h1><h2 id="State"><a href="#State" class="headerlink" title="State"></a>State</h2><p>用于存储共享的状态数据。</p>
<p>用法:<br>首先确保引入了vue及vuex。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// 如使用写法2需引入mapState</span><br><span class="line">var mapState = Vuex.mapState;</span><br><span class="line">// 初始化store实例</span><br><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        count: 0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 创建一个 Counter 组件</span><br><span class="line">const Counter = &#123;</span><br><span class="line">  template: `&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    // 写法1</span><br><span class="line">    count () &#123;</span><br><span class="line">      return store.state.count // 通过计算属性获取共享的count值</span><br><span class="line">    &#125;</span><br><span class="line">    /* // 写法2，使用mapState辅助函数，当state中共享数据比较多时使用，减少重复和冗余</span><br><span class="line">    ...mapState([</span><br><span class="line">        &apos;count&apos;</span><br><span class="line">    ]) */</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: &apos;#app&apos;, // 根元素</span><br><span class="line">    // 把 store 对象提供给 “store” 选项，这可以把 store 的实例注入所有的子组件</span><br><span class="line">    store: store,</span><br><span class="line">    components: &#123; Counter &#125;, // 注册Counter组件</span><br><span class="line">    template: `</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">      &lt;counter&gt;&lt;/counter&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    `</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h2><p>主要用于对state中的数据进行一些后续处理，如过滤等。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">// 如使用写法2需引入mapGetters</span><br><span class="line">var mapGetters = Vuex.mapGetters;</span><br><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    todos: [</span><br><span class="line">      &#123; id: 1, text: &apos;event1&apos;, done: true &#125;,</span><br><span class="line">      &#123; id: 2, text: &apos;event2&apos;, done: false &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    doneTodos: state =&gt; &#123;</span><br><span class="line">      return state.todos.filter(todo =&gt; todo.done)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 创建一个 Todos 组件</span><br><span class="line">const Todos = &#123;</span><br><span class="line">  template: `&lt;div v-for=&quot;done in doneTodos&quot;&gt;&#123;&#123;done.id&#125;&#125; - &#123;&#123;done.text&#125;&#125;&lt;/div&gt;`,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    // 写法1</span><br><span class="line">    doneTodos () &#123;</span><br><span class="line">        return store.getters.doneTodos</span><br><span class="line">    &#125;</span><br><span class="line">    // 写法2</span><br><span class="line">    /*</span><br><span class="line">    ...mapGetters([</span><br><span class="line">        &apos;doneTodos&apos;</span><br><span class="line">    ])</span><br><span class="line">    */</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: &apos;#app&apos;, // 根元素</span><br><span class="line">    // 把 store 对象提供给 “store” 选项，这可以把 store 的实例注入所有的子组件</span><br><span class="line">    store: store,</span><br><span class="line">    components: &#123; Todos &#125;, // 注册Counter组件</span><br><span class="line">    template: `</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">      &lt;todos /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    `</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h2><p>更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。Vuex 中的 mutation 非常类似于事件：每个 mutation 都有一个字符串的 事件类型 (type) 和 一个 回调函数 (handler)。这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">var mapState = Vuex.mapState;</span><br><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: 1,</span><br><span class="line">    count1: 4</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      // 变更状态</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;,</span><br><span class="line">    substract (state, payload) &#123;</span><br><span class="line">        state.count1 -= payload</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">store.commit(&apos;increment&apos;); // 相当于触发事件,使store.state.count自增了1</span><br><span class="line">//</span><br><span class="line">store.commit(&apos;substract&apos;, 4); // 可以传入额外参数，即mutation的载荷（payload）</span><br><span class="line"></span><br><span class="line">// 创建一个 Counter 组件</span><br><span class="line">const Counter = &#123;</span><br><span class="line">  template: `&lt;div&gt;&#123;&#123; count &#125;&#125; - &#123;&#123; count1 &#125;&#125;&lt;/div&gt;`,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    // 写法1</span><br><span class="line">    /* count () &#123;</span><br><span class="line">      return store.state.count // 通过计算属性获取共享的count值</span><br><span class="line">    &#125;,</span><br><span class="line">    count1() &#123;</span><br><span class="line">        return store.state.count1</span><br><span class="line">    &#125;, */</span><br><span class="line">    // 写法2</span><br><span class="line">    ...mapState([</span><br><span class="line">        &apos;count&apos;,</span><br><span class="line">        &apos;count1&apos;</span><br><span class="line">    ])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: &apos;#app&apos;, // 根元素</span><br><span class="line">    // 把 store 对象提供给 “store” 选项，这可以把 store 的实例注入所有的子组件</span><br><span class="line">    store: store,</span><br><span class="line">    components: &#123; Counter &#125;, // 注册Counter组件</span><br><span class="line">    template: `</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">      &lt;counter&gt;&lt;/counter&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    `</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h2><p>Action 类似于 mutation，不同在于：</p>
<ul>
<li>Action 提交的是 mutation，而不是直接变更状态。</li>
<li>Action 可以包含任意异步操作。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">var mapState = Vuex.mapState;</span><br><span class="line">var mapActions = Vuex.mapActions;</span><br><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;,</span><br><span class="line">    incrementAsync (state, payload) &#123;</span><br><span class="line">        state.count += payload.amount</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment (context) &#123;</span><br><span class="line">      context.commit(&apos;increment&apos;)</span><br><span class="line">    &#125;,</span><br><span class="line">    incrementAsync (&#123; commit &#125;, payload) &#123;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      commit(&apos;incrementAsync&apos;, payload)</span><br><span class="line">    &#125;, 1000)&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Action 通过 store.dispatch 方法触发</span><br><span class="line">store.dispatch(&apos;increment&apos;);</span><br><span class="line"></span><br><span class="line">// 以载荷形式分发</span><br><span class="line">store.dispatch(&apos;incrementAsync&apos;, &#123;</span><br><span class="line">  amount: 10</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 创建一个 Counter 组件</span><br><span class="line">const Counter = &#123;</span><br><span class="line">  template: `&lt;div&gt;</span><br><span class="line">               &lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;</span><br><span class="line">                &lt;button @click=&quot;increment&quot;&gt;同步增加&lt;/button&gt;</span><br><span class="line">                &lt;button @click=&quot;incrementAsync(&#123;amount: 10&#125;)&quot;&gt;异步增加&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;`,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    // 写法1</span><br><span class="line">    /* count () &#123;</span><br><span class="line">      return store.state.count // 通过计算属性获取共享的count值</span><br><span class="line">    &#125;,</span><br><span class="line">    count1() &#123;</span><br><span class="line">        return store.state.count1</span><br><span class="line">    &#125;, */</span><br><span class="line">    // 写法2</span><br><span class="line">    ...mapState([</span><br><span class="line">        &apos;count&apos;</span><br><span class="line">    ])</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">      ...mapActions([</span><br><span class="line">          &apos;increment&apos;,</span><br><span class="line">          &apos;incrementAsync&apos;</span><br><span class="line">      ])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: &apos;#app&apos;, // 根元素</span><br><span class="line">    // 把 store 对象提供给 “store” 选项，这可以把 store 的实例注入所有的子组件</span><br><span class="line">    store: store,</span><br><span class="line">    components: &#123; Counter &#125;, // 注册Counter组件</span><br><span class="line">    template: `</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">      &lt;counter&gt;&lt;/counter&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    `</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<iframe src="https://codepen.io/yukuan1991/pen/OGoMQo" width="100%" height="400">

</iframe>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/28/前端知识归纳（8）-安全攻防战/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/28/前端知识归纳（8）-安全攻防战/" itemprop="url">前端知识归纳（8）-- 安全攻防战</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-28T11:42:23+08:00">
                2019-01-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/01/28/前端知识归纳（8）-安全攻防战/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/01/28/前端知识归纳（8）-安全攻防战/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3.2k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="XSS-Cross-Site-Script"><a href="#XSS-Cross-Site-Script" class="headerlink" title="XSS(Cross Site Script)"></a>XSS(Cross Site Script)</h1><p>跨站脚本攻击</p>
<ul>
<li>反射型 诱导用户点击恶意链接来造成一次性攻击<ul>
<li>反射型 XSS，也可称为非持久型 XSS。</li>
<li>其攻击方式往往是通过诱导用户去点击一些带有恶意脚本参数的 URL而发起的。</li>
<li>事实上由于反射型 XSS 因为 url 特征导致很容易被防御。很多浏览器如 Chrome 都内置了 相应的 XSS 过滤器，来防范用户点击了反射型 XSS 的恶意链接</li>
<li>反射型 XSS 归根到底就是由于不可信的用户输入被服务器在没有安全防范处理，然后就直接使用到响应页面中，然后反射给用户而导致代码在浏览器执行的一种 XSS 漏洞。</li>
</ul>
</li>
<li>存储型 恶意代码存储到漏洞服务器中，用户浏览相关页面发起攻击。<ul>
<li>持久型 XSS 其实就是由于不可信的用户输入在没有任何验证的情况下保存在服务端的文件或者数据库中，并且取出不可信的数据时也没有做相关安全处理就返回响应，导致了存储的恶意脚本数据在浏览器中执行的一种 XSS 漏洞。  <h2 id="xss防御"><a href="#xss防御" class="headerlink" title="xss防御"></a>xss防御</h2></li>
<li>httpOnly</li>
<li>输入检查</li>
<li>输出检查<h3 id="输入检查"><a href="#输入检查" class="headerlink" title="输入检查"></a>输入检查</h3><h4 id="实现函数-filter"><a href="#实现函数-filter" class="headerlink" title="实现函数 filter"></a>实现函数 filter</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 正则获取危险标签</span><br><span class="line">var REGEXP_TAG = /&lt;(script|style|iframe)[^&lt;&gt;]*?&gt;.*?&lt;\/\1&gt;/ig;</span><br><span class="line">// 正则获取危险标签属性</span><br><span class="line">var REGEXP_ATTR_NAME = /(onerror|onclick)=([\&quot;\&apos;]?)([^\&quot;\&apos;&gt;]*?)\2/ig;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 过滤函数</span><br><span class="line"> * @param &#123;String&#125; str</span><br><span class="line"> */</span><br><span class="line">function filter(str) &#123;</span><br><span class="line">  return String(str)</span><br><span class="line">    .replace(REGEXP_TAG, &apos;&apos;)</span><br><span class="line">    .replace(REGEXP_ATTR_NAME, &apos;&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>注：这里说明下，事实上富文本更倾向于使用白名单的形式(只可以使用指定的标签和属性)来实现输入检查。</p>
<h4 id="实现-htmlEncode"><a href="#实现-htmlEncode" class="headerlink" title="实现 htmlEncode"></a>实现 htmlEncode</h4><p>htmlEncode 逻辑比较简单，通常来说只需要过滤几个重要字符即可，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 转义 HTML 特殊字符</span><br><span class="line"> * @param &#123;String&#125; str</span><br><span class="line"> */</span><br><span class="line">function htmlEncode(str) &#123;</span><br><span class="line">  return String(str)</span><br><span class="line">    .replace(/&amp;/g, &apos;&amp;amp;&apos;)</span><br><span class="line">    .replace(/&quot;/g, &apos;&amp;quot;&apos;)</span><br><span class="line">    .replace(/&apos;/g, &apos;&amp;#39;&apos;)</span><br><span class="line">    .replace(/&lt;/g, &apos;&amp;lt;&apos;)</span><br><span class="line">    .replace(/&gt;/g, &apos;&amp;gt;&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h3><p>在真实的业务开发中，输入检查所做的工作更为全面和复杂。目前有许多十分完善通用的 XSS 防范的代码库，大家可以结合理解去阅读和试用下：</p>
<ul>
<li><a href="https://github.com/ESAPI/node-esapi/blob/master/lib/esapi.js" target="_blank" rel="noopener">node-esapi</a></li>
<li><a href="https://github.com/leizongmin/js-xss" target="_blank" rel="noopener">js-xss</a></li>
</ul>
<h1 id="Web-相关编码和转义"><a href="#Web-相关编码和转义" class="headerlink" title="Web 相关编码和转义"></a>Web 相关编码和转义</h1><p>提到 Web 前端安全，第一个想到的就是 XSS。<br>而提到 XSS，不得不说的就是编码了。事实上，编码涉及的知识十分的复杂，很难短时间梳理清楚和弄明白。在这里只要求大家对编码有一个概念就好，日后再进行深究。</p>
<h2 id="常用编码"><a href="#常用编码" class="headerlink" title="常用编码"></a>常用编码</h2><p>本文从 XSS 中常用的编码讲起，分为</p>
<ul>
<li><strong>URL 编码</strong></li>
<li><strong>HTML 编码</strong></li>
<li><strong>JS 编码</strong></li>
</ul>
<h2 id="URL编码"><a href="#URL编码" class="headerlink" title="URL编码"></a>URL编码</h2><p>一般来说，URL只能使用英文字母（<code>a-zA-Z</code>）、数字（<code>0-9</code>）、<code>-_.~</code>4个特殊字符以及所有（<code>;,/?:@&amp;=+$#</code>）保留字符。</p>
<p>意味着如果使用了一些其他文字和特殊字符，则需要通过编码的方式来进行表示，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 使用了汉字</span><br><span class="line">var url1 = &apos;http://www.帅.com&apos;;</span><br></pre></td></tr></table></figure>
<p>另外我们知道在 URL 中传参是通过<strong>键值对</strong>形式进行的，格式上是以<code>？</code>、<code>&amp;</code> 和 <code>=</code> 为特征标识进行解析，如果在键或者值的内容中包含一些特殊符号，就会造成解析错误，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 键为汉字</span><br><span class="line">var url2 = &apos;http://www.a.com?我=1&apos;;</span><br><span class="line">// 值的内容为特殊符号</span><br><span class="line">var url3 = &apos;http://a.com?key=?&amp;&apos;;</span><br></pre></td></tr></table></figure>
<p>对于上面的情况如果我们要正常解析，则需要进行编码，需要用不会造成歧义的符号代替有歧义的符号。</p>
<p>我们可以通过使用系统原生实现的 API 来对字符进行 <strong>URL 编码</strong>如:</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/encodeURI" target="_blank" rel="noopener">encodeURI()</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent" target="_blank" rel="noopener">encodeURIComponent()</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/escape" target="_blank" rel="noopener">escape 逐渐废弃可以不理会</a></li>
</ul>
<h3 id="encodeURI"><a href="#encodeURI" class="headerlink" title="encodeURI"></a>encodeURI</h3><p><strong>encodeURI</strong> 是用来编码 URI 的，最常见的就是编码一个 URL。<strong>encodeURI</strong> 会将需要编码的字符转换为 <code>UTF-8</code> 的格式。对于保留字符（<code>;,/?:@&amp;=+$#</code>），以及非转义字符（字母数字以及 <code>-_.!~*&#39;()</code>）不会进行转义。</p>
<p>例如之前 URL 中包含中文，我们可以使用 encodeURI：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">encodeURI(&apos;http://www.帅.com&apos;); // http://www.%E5%B8%85.com</span><br><span class="line">encodeURI(&apos;http://www.a.com?我=1&apos;);// &quot;http://www.a.com?%E6%88%91=1&quot;</span><br></pre></td></tr></table></figure>
<p>在这里，<code>%E5%B8%85</code> 就是 <code>帅</code> 的 URL 编码，<code>%E6%88%91</code> 即为 <code>我</code> 的 URL 编码。然后由于 <strong>encodeURI</strong> 不转义<code>&amp;</code>、<code>?</code>和<code>=</code>。所以对于 URL 参数的值是无法转义的，如下面的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 值的内容为特殊符号</span><br><span class="line">encodeURI(&apos;http://a.com?key=?&amp;&apos;); // &quot;http://a.com?key=?&amp;&quot;</span><br></pre></td></tr></table></figure>
<p>此时我们就需要使用 <strong>encodeURIComponent</strong> 来解决。</p>
<h3 id="encodeURIComponent"><a href="#encodeURIComponent" class="headerlink" title="encodeURIComponent"></a>encodeURIComponent</h3><p>顾名思义，<strong>encodeURIComponent</strong> 是用来编码 URI 参数的。它会跳过非转义字符（字母数字以及<code>-_.!~*&#39;()</code>）。但会转义 URL的 保留字符（<code>;,/?:@&amp;=+$#</code>）。通常来说我们会 <strong>encodeURI</strong> 结合 <strong>encodeURIComponent</strong> 来使用，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// &quot;http://a.com?a=%3F%26&quot;</span><br><span class="line">encodeURI(&apos;http://a.com&apos;) + &apos;?a=&apos; + encodeURIComponent(&apos;?&amp;&apos;);</span><br></pre></td></tr></table></figure>
<p>其中 <code>%3F</code> 和 <code>%26</code> 分别为 <code>?</code> 和 <code>&amp;</code> 的 URL 编码。需注意的是由于 <strong>encodeURIComponent</strong> 会编码所有的 URL 保留字，所以不适合编码 URL，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// &quot;http%3A%2F%2Fa.com%3Fkey%3D%3F%26&quot;</span><br><span class="line">encodeURIComponent(&apos;http://a.com?key=?&amp;&apos;);</span><br></pre></td></tr></table></figure>
<p>上面的 <code>http%3A%2F%2Fa.com%3Fkey%3D%3F%26</code> 在地址栏会被解析为一个普通的字符串而不是 URL。</p>
<h2 id="URL-解码"><a href="#URL-解码" class="headerlink" title="URL 解码"></a>URL 解码</h2><p>有了 URL 编码，相应的会有解码机制。比如上面对应的 3个 encode 的API对应的解码 API 如下：</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/decodeURI" target="_blank" rel="noopener">decodeURI()</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/decodeURIComponent" target="_blank" rel="noopener">decodeURIComponent()</a></li>
</ul>
<h2 id="HTML-编码"><a href="#HTML-编码" class="headerlink" title="HTML 编码"></a>HTML 编码</h2><p>在 HTML 中，某些字符是预留的，比如不能使用小于号（<code>&lt;</code>）和大于号（<code>&gt;</code>），这是因为浏览器会误认为它们是标签。如果希望正确地显示预留字符，我们必须在 HTML 源代码中使用字符实体（character entities）。当然还另一个重要原因，有些字符在 ASCII 字符集中没有定义，因此需要使用字符实体来表示，比如中文。</p>
<p>HTML 编码分为：</p>
<ul>
<li>HTML 十六进制编码 <code>&amp;#xH;</code></li>
<li>HTML 十进制编码 <code>&amp;#D;</code></li>
<li>HTML 实体编码 <code>&amp;lt;</code> 等</li>
</ul>
<p>在 HTML 进制编码中其中的数字则是对应字符的 unicode 字符编码。<br>比如单引号的 unicode 字符编码是27，则单引号可以被编码为<code>&amp;#x27;</code></p>
<h3 id="HTML-实体编码"><a href="#HTML-实体编码" class="headerlink" title="HTML 实体编码"></a>HTML 实体编码</h3><p>通常来说，在业务中我们用到更多的是 HTML 的实体编码。常用的 HTML 实体编码函数如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 转义 HTML 特殊字符</span><br><span class="line"> * @param &#123;String&#125; str</span><br><span class="line"> */</span><br><span class="line">function htmlEncode(str) &#123;</span><br><span class="line">  return String(str)</span><br><span class="line">    .replace(/&amp;/g, &apos;&amp;amp;&apos;)</span><br><span class="line">    .replace(/&quot;/g, &apos;&amp;quot;&apos;)</span><br><span class="line">    .replace(/&apos;/g, &apos;&amp;#39;&apos;)</span><br><span class="line">    .replace(/&lt;/g, &apos;&amp;lt;&apos;)</span><br><span class="line">    .replace(/&gt;/g, &apos;&amp;gt;&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>更完整的转义列表见<a href="http://w3school.com.cn/html/html_entities.asp" target="_blank" rel="noopener">这里</a>。</p>
<h2 id="Javascript-转义"><a href="#Javascript-转义" class="headerlink" title="Javascript 转义"></a>Javascript 转义</h2><p>JavaScript 中有些字符有特殊用途，如果字符串中想使用这些字符原来的含义，需要使用反斜杠对这些特殊符号进行<a href="http://www.w3school.com.cn/js/js_special_characters.asp" target="_blank" rel="noopener">转义</a>。我们称之为 <strong>Javascript编码</strong>。一般有以下几类：</p>
<ul>
<li>三个八进制数字，如果不够个数，前面补0，例如 “e” 编码为“\145”</li>
<li>两个十六进制数字，如果不够个数，前面补0，例如 “e” 编码为“\x65”</li>
<li>四个十六进制数字，如果不够个数，前面补0，例如 “e” 编码为“\u0065”</li>
<li>对于一些控制字符，使用特殊的C类型的转义风格（例如\n和\r）</li>
</ul>
<p>如下面所示，双引号用于标注字符串，然而在字符串中带了双引号，就会发生歧义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var str = &quot;Hello&quot;&quot;;</span><br></pre></td></tr></table></figure>
<p>于是我们需要对字符串内的双引号进行转义，也就是加上反斜杠，告诉脚本引擎要区分对待：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var str = &quot;Hello\&quot;&quot;;</span><br></pre></td></tr></table></figure>
<h2 id="更多阅读"><a href="#更多阅读" class="headerlink" title="更多阅读"></a>更多阅读</h2><p>对 Web 相关编码和转义十分感兴趣的同学可以阅读下面的文章和内容来加深理解。</p>
<ul>
<li><a href="https://github.com/FrankFang/githublog/blob/master/%E6%8A%80%E6%9C%AF/%E5%89%8D%E7%AB%AF%E7%9A%84%E5%90%84%E7%A7%8D%E8%BD%AC%E4%B9%89.md" target="_blank" rel="noopener">前端的各种转义</a></li>
<li><a href="http://imweb.io/topic/57024e4606f2400432c1396d" target="_blank" rel="noopener">从零开始学web安全（3）</a></li>
</ul>
<h1 id="CSRF-Cross-site-request-forgery"><a href="#CSRF-Cross-site-request-forgery" class="headerlink" title="CSRF(Cross-site request forgery)"></a>CSRF(Cross-site request forgery)</h1><p>跨站请求伪造</p>
<h2 id="csrf防御"><a href="#csrf防御" class="headerlink" title="csrf防御"></a>csrf防御</h2><ul>
<li>验证码 针对伪造请求一般是用户不知情情况下发出的，我们一般会在关键操作增加验证码</li>
<li>reference验证 针对伪造请求一般是从别的网站发出的，可以通过验证请求的 referer 来防御</li>
<li>token验证 伪造请求可以成功的最主要还是因为我们的参数是可预测的，攻击者可以通过分析我们的请求，伪造相应的参数进行攻击，所以我们最好最常用的方式还是让每个请求都带上服务器返回的，不可预测的参数，这也就是我们说的 anti CSRF token。</li>
</ul>
<h1 id="DDOS防范"><a href="#DDOS防范" class="headerlink" title="DDOS防范"></a>DDOS防范</h1><p>在许多黑客题材的电视剧电影中，我们可以看到 <strong>DDOS (分布式拒绝服务) 攻击</strong>经常出现。DDOS 出镜率之所以高是因为其易攻难守。十多年过去了，DDOS 攻击仍是业界安全问题中一个难题，当攻击流量超过了服务的网络设备的极限或带宽的最大负荷时，网站服务将瘫痪导致无法正常运作。</p>
<p>通常来说，对于 DDOS 攻击我们可以通过下面的方式来进行防范。</p>
<h2 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a>验证码</h2><p>验证码是我们在互联网十分常见的技术之一。不得不说验证码是能够有效地防止多次重复请求的行为。目前来说，随着验证码方式的丰富化，导致黑客们没有一个比较有效的方式来获取和识别验证码。但由于验证码会影响到用户体验，因此验证码只有在比较重要的入口才会使用，如转账和登陆的场景。</p>
<h2 id="限制请求频率（ratelimit）"><a href="#限制请求频率（ratelimit）" class="headerlink" title="限制请求频率（ratelimit）"></a>限制请求频率（ratelimit）</h2><p><strong>限制请求频率</strong>是我们最常见的针对 DDOS 攻击的防御措施。其原理为设置每个<strong>客户端</strong>的请求频率的限制。简单来说，就是通过一些标识（如 IP 与 Cookie）来定位一个客户端，如果该客户端的请求在一定时间内过于频繁。则对该客户端之后的请求都重定向到一个出错的页面或者封杀相关 IP。</p>
<p>当然许多框架都会有相应地限制请求频率的工具包，如 <code>koa</code> 框架便可以使用下面这些：</p>
<ul>
<li><a href="https://github.com/cnpm/koa-limit" target="_blank" rel="noopener">koa-limit</a></li>
<li><a href="https://github.com/koajs/ratelimit" target="_blank" rel="noopener">koa-ratelimit</a></li>
</ul>
<h2 id="扩容加带宽"><a href="#扩容加带宽" class="headerlink" title="扩容加带宽"></a>扩容加带宽</h2><p>简单来说就是，增加机器增加服务带宽。只要超过了攻击流量便可以避免服务瘫痪。在<strong>双十一活动</strong>或者<strong>12306 抢车票</strong>等场景时，网站服务都会对自己的机器进行扩容和提高带宽。然而为了避免由于使用过多机器导致成本太高且浪费的情况。通常来说都是根据网站活动和请求情况来实施相应扩容操作。</p>
<h2 id="其他的方法"><a href="#其他的方法" class="headerlink" title="其他的方法"></a>其他的方法</h2><p>事实上还有许多其他的方法，根据不同情况都有相应的效果</p>
<ul>
<li>设置自己的业务为分布式服务，防止单点失效</li>
<li>使用主流云系统和 CDN（云和 CDN 其自身有 DDOS 的防范作用）</li>
<li>优化资源使用提高 web server 的负载能力</li>
</ul>
<h2 id="更多阅读-1"><a href="#更多阅读-1" class="headerlink" title="更多阅读"></a>更多阅读</h2><p>网上有许多 DDOS 的帖子，大家感兴趣可以阅读下：</p>
<ul>
<li><a href="https://www.zhihu.com/question/19581905" target="_blank" rel="noopener">互联网创业公司如何防御 DDOS 攻击？</a></li>
<li><a href="https://www.leiphone.com/news/201509/9zGlIDvLhwguqOtg.html" target="_blank" rel="noopener">漫画告诉你什么是DDoS攻击？</a></li>
</ul>
<h1 id="更多安全内容"><a href="#更多安全内容" class="headerlink" title="更多安全内容"></a>更多安全内容</h1><p>在本章，我们讲了 XSS，CSRF 攻击和防御，还有介绍 DDOS，HTTPS 相关内容，相信大家对 Web 安全已经有了初步的认识了。当然，我们这里介绍主要是比较常见的而且是偏前端的 Web 安全知识，实际上 Web 安全很多其他方面，因为内容限制我们在课程就不给大家一一展开，感兴趣的可以根据下面的指引继续了解。</p>
<h2 id="点击劫持"><a href="#点击劫持" class="headerlink" title="点击劫持"></a>点击劫持</h2><p>点击劫持实际上就是在正常界面上覆盖一层透明的内容，引导用户在不知情的情况下进行了某些操作，这些操作可能是广告点击，或者是开启摄像头等操作，甚至可能会导致一些数据别窃取，也有可能结合 XSS 和 CSRF 进行更负责的攻击。</p>
<h2 id="服务端安全"><a href="#服务端安全" class="headerlink" title="服务端安全"></a>服务端安全</h2><p>除了前端注意安全，后端也需要对安全进行防范，常见比如防止 SQL 注入，登录会话管理等。</p>
<h2 id="更多阅读-2"><a href="#更多阅读-2" class="headerlink" title="更多阅读"></a>更多阅读</h2><p>身为一名前端工程师，要学会如何去保护好自己的网站。</p>
<ul>
<li><a href="http://www.jianshu.com/p/251704d8ff18" target="_blank" rel="noopener">web安全之–点击劫持攻击与防御技术简介</a></li>
<li>《白帽子讲 Web 安全》相关内容</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/28/前端知识归纳（7）-JS应用开发（part4-React）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/28/前端知识归纳（7）-JS应用开发（part4-React）/" itemprop="url">前端知识归纳（7）-- JS应用开发（part4 React）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-28T11:38:21+08:00">
                2019-01-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/01/28/前端知识归纳（7）-JS应用开发（part4-React）/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/01/28/前端知识归纳（7）-JS应用开发（part4-React）/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  597
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="React-体系"><a href="#React-体系" class="headerlink" title="React 体系"></a>React 体系</h1><h2 id="React-库"><a href="#React-库" class="headerlink" title="React 库"></a>React 库</h2><p>到目前为止，大家已经学习了 React 的基本内容，算是入门了。</p>
<p>当然，受课程内容限制，我们只能带大家了解 React 使用的最基本的概念，有些原理性或者高级的概念在课程里面没有介绍到，比如虚拟 DOM 概念，PropTypes，高阶组件等等，感兴趣的同学可以研究下。研究过程中如果感到摸不着头脑，不要慌，很正常，把问题放在脑子里，然后花更多的时间研究。</p>
<ul>
<li><a href="http://www.alloyteam.com/2015/10/react-virtual-analysis-of-the-dom/" target="_blank" rel="noopener">虚拟 Dom</a></li>
<li><a href="https://doc.react-china.org/react/docs/typechecking-with-proptypes.html" target="_blank" rel="noopener">PropTypes</a></li>
<li><a href="https://doc.react-china.org/react/docs/higher-order-components.html" target="_blank" rel="noopener">高阶组件</a></li>
</ul>
<p>下面给大家提供一些学习的资源，供大家参考。</p>
<p>首先是 React 的<a href="https://facebook.github.io/react/" target="_blank" rel="noopener">官网</a>(<a href="https://doc.react-china.org/" target="_blank" rel="noopener">翻译版</a>)，React 官方文档还是比较容易看懂的，还有附带教程，大家也可以跟着官方教程去练习。我们推荐最原始的英文官网，因为那里是更新的最快最及时的。</p>
<p>另外大家推荐一本小书， <a href="http://huziketang.com/books/react/" target="_blank" rel="noopener">React.js 小书</a>，这本书比较适合新手，由浅入深，讲得还不错。</p>
<h2 id="React-的衍生"><a href="#React-的衍生" class="headerlink" title="React 的衍生"></a>React 的衍生</h2><p>我们经常说的 React ，可以称为 React Core ，2011 年由 Facebook 工程师 Jordan Walke 创建，六七年时间过去了，React 现在是一个巨无霸。</p>
<p>React Core 有很大的变化，它进一步的分化出了 React Core、React DOM、React Server 。Core 不多说，React DOM 是用于浏览器，React Server 用于 Nodejs ，它的魔爪已经伸向了服务端，就是这个服务端渲染的特性被很多框架所借鉴，算是开启了一个时代。</p>
<p>围绕这个 React Core ，大批量的辅助库涌现了出来，典型的如 <a href="https://github.com/ReactTraining/react-router" target="_blank" rel="noopener">React Router</a>、<a href="https://github.com/reactjs/redux" target="_blank" rel="noopener">Redux</a> ，生态越来庞大，于是又有了 <a href="https://ant.design/index-cn" target="_blank" rel="noopener">ant-design</a>这些大而全的框架。</p>
<p>前端和服务端都被 React 占领，它还没有停歇，触角又伸向了 iOS 和 Android ，<a href="https://facebook.github.io/react-native/" target="_blank" rel="noopener">React-Native</a> ，从此我们可以用 HTML CSS JS 写出手机端应用。</p>
<p>所以啊，在众多的库和框架当中，我们选择 React 介绍给大家。如果说前端是一个世界，那么 React 从这个世界衍生出了一个更为广阔的世界。现在给大家开了一扇窗，如果喜欢，你们就要靠自己的双手开出一扇门了，努力！</p>
<h2 id="一些资源"><a href="#一些资源" class="headerlink" title="一些资源"></a>一些资源</h2><ul>
<li><a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React 官网</a></li>
<li><a href="https://doc.react-china.org/" target="_blank" rel="noopener">官网翻译版</a></li>
<li><a href="http://huziketang.com/books/react/" target="_blank" rel="noopener">React.js 小书</a></li>
<li><a href="http://www.alloyteam.com/2015/10/react-virtual-analysis-of-the-dom/" target="_blank" rel="noopener">虚拟 Dom</a></li>
<li><a href="https://doc.react-china.org/docs/typechecking-with-proptypes.html" target="_blank" rel="noopener">PropTypes</a></li>
<li><a href="https://doc.react-china.org/docs/higher-order-components.html" target="_blank" rel="noopener">高阶组件</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/28/前端知识归纳（7）-JS应用开发（part3-设计模式）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/28/前端知识归纳（7）-JS应用开发（part3-设计模式）/" itemprop="url">前端知识归纳（7）-- JS应用开发（part3 设计模式）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-28T10:30:39+08:00">
                2019-01-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/01/28/前端知识归纳（7）-JS应用开发（part3-设计模式）/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/01/28/前端知识归纳（7）-JS应用开发（part3-设计模式）/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3.2k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h1><p>确保一个类只有一个实例共享使用。<br>优点：节省资源，控制入口。<br>缺点：拓展困难，不可指责过重。<br>适合的例子：</p>
<ul>
<li>网站的登录框</li>
<li>网站的计时器</li>
<li>应用程序中可全局访问的配置对象</li>
</ul>
<h1 id="适配器模式"><a href="#适配器模式" class="headerlink" title="适配器模式"></a>适配器模式</h1><h2 id="适配器模式的使用场景"><a href="#适配器模式的使用场景" class="headerlink" title="适配器模式的使用场景"></a>适配器模式的使用场景</h2><p>事实上，适配器模式可以说是一种“亡羊补牢”的模式适配器模式，其并不是我们设计之初想要使用到的。</p>
<p>因为如果我们系统和应用原本的接口能够正常工作的话，相信我们并不会使用上适配器模式。然而在业务中，我们经常会发现，对于过去能够好好工作的接口，或许在未来的某一天却发现已经不能适用于新的系统了。此时如果对系统进行重构耗费的精力和时间太大了。</p>
<p>这时候我们就可以考虑使用<strong>适配器模式把旧接口包装成一个新的接口，使它继续保持生命力。</strong></p>
<h1 id="装饰器模式"><a href="#装饰器模式" class="headerlink" title="装饰器模式"></a>装饰器模式</h1><p>在不修改类原来的接口下，动态地为对象添加功能。</p>
<h1 id="ES7-的-Decorator"><a href="#ES7-的-Decorator" class="headerlink" title="ES7 的 Decorator"></a>ES7 的 Decorator</h1><p>在许多面向对象的语言中都有<strong>装饰器（Decorator）</strong>，用来增加类的功能和职责。</p>
<p>令人喜悦的是，在未来的 JavaScript 中也引入了这个概念，目前 babel 对这个概念也有很好的支持。如果你是一个喜欢尝试新技术的开发者，可以借助 babel 来大胆使用它。下面让我们来了解一下更多内容。</p>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p><code>Decorator</code> 在目前还只是一个提议。如果你现在就想要体验使用的话，可以通过下面两种方法：</p>
<h3 id="通过使用-Babel-来转换使用"><a href="#通过使用-Babel-来转换使用" class="headerlink" title="通过使用 Babel 来转换使用"></a>通过使用 <code>Babel</code> 来转换使用</h3><ol>
<li><p>首先全局安装babel组件模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel -g</span><br></pre></td></tr></table></figure>
</li>
<li><p>命令行开启 <code>Decorator</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel --optional es7.decorators test.js &gt; test.es5.js</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="通过-在线的-REPL-提前体验"><a href="#通过-在线的-REPL-提前体验" class="headerlink" title="通过 在线的 REPL 提前体验"></a>通过 <a href="http://babeljs.io/repl/" target="_blank" rel="noopener">在线的 REPL</a> 提前体验</h3><p>Babel 的官方网站提供一个在线转码器，其支持 Decorator 的在线转码。</p>
<h2 id="JavaScript-的-Decorator"><a href="#JavaScript-的-Decorator" class="headerlink" title="JavaScript 的 Decorator"></a>JavaScript 的 Decorator</h2><p><strong>装饰器（Decorator）</strong> 在现代编程语言中是相当普遍的。事实上，JavaScript 装饰器的语法与 Python 装饰器的语法非常相似。有以下两种用法：</p>
<ul>
<li>装饰类</li>
<li>装饰类的方法</li>
</ul>
<h2 id="装饰类"><a href="#装饰类" class="headerlink" title="装饰类"></a>装饰类</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@superManPower</span><br><span class="line">class Man &#123;</span><br><span class="line">  // some code</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 装饰器函数</span><br><span class="line">function superManPower(target) &#123;</span><br><span class="line">  target.super = true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 等同于</span><br><span class="line">class Man &#123;&#125;</span><br><span class="line">// 装饰器函数 superFunc</span><br><span class="line">function superManPower(target) &#123;</span><br><span class="line">  this.super = true;</span><br><span class="line">&#125;</span><br><span class="line">Man = superManPower(Man) || Man;</span><br></pre></td></tr></table></figure>
<p>上面是简单的一个 <strong>装饰器（Decorator）</strong> 的例子，其中</p>
<ul>
<li><code>@superManPower</code> 则为使用<strong>装饰器 superManPower</strong></li>
<li><strong>装饰器 superManPower</strong> 修改了类 <code>Man</code> 的行为，给其加上静态属性 <code>super</code></li>
<li><p>此时装饰器函数是一个对类进行处理的函数。其第一个参数为需要被装饰的目标类，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 装饰器函数</span><br><span class="line">function superManPower(target) &#123;</span><br><span class="line">  // target 即为被装饰的目标</span><br><span class="line">  target.super = true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="装饰类的方法"><a href="#装饰类的方法" class="headerlink" title="装饰类的方法"></a>装饰类的方法</h2><p>装饰器除了可以装饰我们的类之外，还可以修饰类的属性方法。如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">function superInitPower(attack, defense) &#123;</span><br><span class="line">  return function(target, key, descriptor) &#123;</span><br><span class="line">    // 保存方法</span><br><span class="line">    const method = descriptor.value;</span><br><span class="line">    // 修改方法</span><br><span class="line">    descriptor.value = (...args)=&gt;&#123;</span><br><span class="line">      // 增加攻击力和防御力</span><br><span class="line">      args[0] += 100;</span><br><span class="line">      args[1] += 100;</span><br><span class="line">      // 调用原本的方法</span><br><span class="line">      return method.apply(target, args);</span><br><span class="line">    &#125;</span><br><span class="line">  return descriptor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Man &#123;</span><br><span class="line">  @superInitPower</span><br><span class="line">  init(attack, defense) &#123;</span><br><span class="line">    this.attack = attack; // 初始攻击力</span><br><span class="line">    this.defense = defense; // 初始攻击力</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时，装饰器函数可以接受三个参数，和我们的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener">Object.defineProperty()</a> 的参数基本保持一致，分别表示如下：</p>
<ul>
<li><p>第一个参数 <code>target</code> 表示修饰的目标对象 即类的实例</p>
<blockquote>
<p>这不同于之前装饰类，之前装饰类 <code>target</code> 表示的是类本身</p>
</blockquote>
</li>
<li><p>第二个参数 <code>key</code> 表示需要装饰的属性名</p>
</li>
<li><p>第三个参数 <code>descriptor</code> 是该属性的描述对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// descriptor 对象的值</span><br><span class="line">&#123;</span><br><span class="line">  value: specifiedFunction, // 指定的方法</span><br><span class="line">  enumerable: false, // 是否可遍历迭代</span><br><span class="line">  configurable: true, </span><br><span class="line">  writable: true</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="多层装饰器"><a href="#多层装饰器" class="headerlink" title="多层装饰器"></a>多层装饰器</h2><p>我们可以同时使用多个装饰器，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@healthy</span><br><span class="line">class Person &#123;</span><br><span class="line">  @runFase</span><br><span class="line">  @eatHuge</span><br><span class="line">  init() &#123; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例如上面的，我们使用了多个装饰器，增加类和类的方法的职责。</p>
<h2 id="更多参数"><a href="#更多参数" class="headerlink" title="更多参数"></a>更多参数</h2><p>上面我们看到装饰器参数都是固定的，对于一些场景可能会不够用。此时我们通过包装一层函数的方式来增加参数，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 装饰器函数 - 增加参数</span><br><span class="line">function superFunc(num, canUse) &#123;</span><br><span class="line">  return function(target) &#123;</span><br><span class="line">    target.canUse = canUse;</span><br><span class="line">    target.num = num;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 因此下面我们就可以这样调用</span><br><span class="line">@superFunc(1, true)</span><br><span class="line">class Base1() &#123;&#125;</span><br><span class="line">Base1.canUse; // true</span><br><span class="line">Base1.num; // 1</span><br><span class="line"></span><br><span class="line">@superFunc(2, false)</span><br><span class="line">class Base2() &#123;&#125;</span><br><span class="line">Base2.canUse; // false</span><br><span class="line">Base2.num; // 2</span><br></pre></td></tr></table></figure>
<p>上面中，我们看到装饰器 <code>superFunc</code> 是可以接受参数，通过各种参数来增强装饰器的能力。</p>
<p><code>注: 装饰器对类的行为的改变，是代码编译时发生的，而不是在运行时。这意味着，装饰器本质就是编译时执行的函数。</code></p>
<h3 id="不能装饰普通函数"><a href="#不能装饰普通函数" class="headerlink" title="不能装饰普通函数"></a>不能装饰普通函数</h3><p>事实上 <strong>装饰器（Decorator）</strong> 只使用与装饰类和类的方法，不能使用于普通函数。这是因为变量提升会产生系列的问题。这里大家可以查看更多阅读来了解相关的问题详情。</p>
<h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><p>我们常常使用 <strong>装饰器（Decorator）</strong> 来实现 <a href="http://qingbob.com/aop-programming/" target="_blank" rel="noopener">AOP(面向切面编程)</a>。例如前面我们习题讲到的日志，也是非常经典的应用：[日志系统]。(<a href="http://taobaofed.org/blog/2015/11/16/es7-decorator/#4%E3%80%81%E7%BB%8F%E5%85%B8%E5%AE%9E%E7%8E%B0%EF%BC%9ALogger" target="_blank" rel="noopener">http://taobaofed.org/blog/2015/11/16/es7-decorator/#4%E3%80%81%E7%BB%8F%E5%85%B8%E5%AE%9E%E7%8E%B0%EF%BC%9ALogger</a>)</p>
<h2 id="更多阅读"><a href="#更多阅读" class="headerlink" title="更多阅读"></a>更多阅读</h2><p>想要了解更多知识，大家可以阅读以下的资料文献。</p>
<ul>
<li><a href="https://github.com/wycats/javascript-decorators" target="_blank" rel="noopener">javascript-decorators</a></li>
<li><a href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841" target="_blank" rel="noopener">Exploring EcmaScript Decorators</a></li>
<li><a href="https://ponyfoo.com/articles/javascript-decorators-proposal" target="_blank" rel="noopener">ECMAScript Proposal for JavaScript Decorators<br>(and protocols)</a></li>
<li><a href="http://es6.ruanyifeng.com/#docs/decorator" target="_blank" rel="noopener">ECMAScript 6 入门 - 阮一峰</a></li>
</ul>
<h1 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h1><h2 id="实现事件监听"><a href="#实现事件监听" class="headerlink" title="实现事件监听"></a>实现事件监听</h2><p>事实上实现事件监听的本质就是保存指定事件的监听处理函数。这里需要保存不同的事件的处理函数，然后监听相同的事件的处理函数都放在同一个数组中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">on: function (eventName, callback) &#123;</span><br><span class="line">  var handlers = this.handlers;</span><br><span class="line"></span><br><span class="line">  // 判断是否有相关事件的监听者，如果没有则创建</span><br><span class="line">  if (!handlers[eventName]) &#123;</span><br><span class="line">    handlers[eventName] = [];</span><br><span class="line">  &#125;</span><br><span class="line">  // 增加指定事件的监听者</span><br><span class="line">  handlers[eventName].push(callback);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="实现事件触发"><a href="#实现事件触发" class="headerlink" title="实现事件触发"></a>实现事件触发</h2><p>事实上实现事件触发相对来说比较简单，我们只需要先获取到指定事件的相关监听处理函数，并循环一一调用即可。如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 触发指定事件</span><br><span class="line">  * @param eventName &#123;string&#125; 事件名称</span><br><span class="line">  */</span><br><span class="line">emit: function (eventName) &#123;</span><br><span class="line">  var eventHandlers = this.handlers[eventName];</span><br><span class="line">  // 循环调用相关观察者处理函数</span><br><span class="line">  if(eventHandlers)&#123;</span><br><span class="line">    for(var i = 0, len = eventHandlers.length; i &lt; len; i++) &#123;</span><br><span class="line">      var handler = eventHandlers[i];</span><br><span class="line">      // 调用</span><br><span class="line">      handler(eventName);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>因此最终参考答案如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">var Event = &#123;</span><br><span class="line">  handlers: &#123;&#125;,</span><br><span class="line">  /**</span><br><span class="line">   * 监听指定函数</span><br><span class="line">   * @param eventName &#123;string&#125; 事件名称</span><br><span class="line">   * @param callback &#123;function&#125; 处理函数</span><br><span class="line">   */</span><br><span class="line">  on: function (eventName, callback) &#123;</span><br><span class="line">    var handlers = this.handlers;</span><br><span class="line"></span><br><span class="line">    // 判断是否有相关事件的监听者，如果没有则创建</span><br><span class="line">    if (!handlers[eventName]) &#123;</span><br><span class="line">      handlers[eventName] = [];</span><br><span class="line">    &#125;</span><br><span class="line">    // 增加指定事件的监听者</span><br><span class="line">    handlers[eventName].push(callback);</span><br><span class="line">  &#125;,</span><br><span class="line">  /**</span><br><span class="line">   * 触发指定事件</span><br><span class="line">   * @param eventName &#123;string&#125; 事件名称</span><br><span class="line">   */</span><br><span class="line">  emit: function (eventName) &#123;</span><br><span class="line">    var eventHandlers = this.handlers[eventName];</span><br><span class="line">    // 循环调用相关观察者处理函数</span><br><span class="line">    if(eventHandlers)&#123;</span><br><span class="line">      for(var i = 0, len = eventHandlers.length; i &lt; len; i++) &#123;</span><br><span class="line">        var handler = eventHandlers[i];</span><br><span class="line">        // 调用</span><br><span class="line">        handler(eventName);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><p>我们这里实现的 Event 对象是比较简单的。事实上，业务使用的 Event 对象拥有更多健壮性和强大的功能代码，大家可以尝试地去实现下面的功能：</p>
<p>去除事件监听 remove<br>通过 return false 或者其他中断后续处理函数的执行</p>
<h1 id="MVC模式"><a href="#MVC模式" class="headerlink" title="MVC模式"></a>MVC模式</h1><p><img src="/2019/01/28/前端知识归纳（7）-JS应用开发（part3-设计模式）/mvc.png" alt="mvc.png"></p>
<h1 id="MVVM模式"><a href="#MVVM模式" class="headerlink" title="MVVM模式"></a>MVVM模式</h1><p><img src="/2019/01/28/前端知识归纳（7）-JS应用开发（part3-设计模式）/mvvm.png" alt="mvvm.png"></p>
<h1 id="数据双向绑定的常见实现原理"><a href="#数据双向绑定的常见实现原理" class="headerlink" title="数据双向绑定的常见实现原理"></a>数据双向绑定的常见实现原理</h1><p>前面讲到的 MVVM 框架，其主要亮点就是实现了视图层和数据层的 <strong>双向绑定(two-way-binding)</strong>。那么双向绑定在前端中是如何实现的呢？在本文中，将给大家讲解数据双向绑定的常见实现方式。</p>
<h2 id="观察者模式实现"><a href="#观察者模式实现" class="headerlink" title="观察者模式实现"></a>观察者模式实现</h2><p>前面我们学习了什么是<strong>观察者模式</strong>。观察者模式可以来实现我们的数据的双向绑定。只不过这种方式需要我们手动地去调用获取和设置数据的指定方法（如 <code>updateData</code> 等）。在数据发生变化的时候，我们发布一个叫<strong>数据变化</strong>的的事件。同理，当视图发生变化的时候，我们发布一个叫<strong>视图变化</strong>的事件。在这些事件发生时只要让相关的观察者去订阅这些事件即可。</p>
<p>如下面的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 更新数据 </span><br><span class="line">var data = &#123;&#125;;</span><br><span class="line">function updateData(attr, value)&#123;</span><br><span class="line">   data[attr] = value;</span><br><span class="line">   Event.trigger(&apos;数据变化&apos;, attr, value);</span><br><span class="line">&#125;</span><br><span class="line">// 订阅视图变化事件 </span><br><span class="line">Event.on(&apos;视图变化&apos;, function(attr, value)&#123;</span><br><span class="line">  // 更新数据</span><br><span class="line">  updateData(attr, value);</span><br><span class="line">&#125;);</span><br><span class="line">// 订阅数据变化事件 </span><br><span class="line">Event.on(&apos;数据变化&apos;, function(attr, value)&#123;</span><br><span class="line">   // 更新绑定的视图</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//用户操作，发布视图变化事件   </span><br><span class="line">document.body.addEventListener(&apos;keyup&apos;, function( e )&#123;</span><br><span class="line">   Event.trigger(&apos;视图变化&apos;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><em>这种方式，是最早期的方式，问题是需要<strong>手动的方式来绑定关系</strong>，对于那种多交互和数据修改的页面就比较繁琐。</em></p>
<h2 id="脏检测-Dirty-Checking-实现"><a href="#脏检测-Dirty-Checking-实现" class="headerlink" title="脏检测 (Dirty Checking)实现"></a>脏检测 (Dirty Checking)实现</h2><p>典型的 angularJS 的数据双向绑定就是基于数据的脏检测机制来实现的。angularJS 通过检查脏数据来进行 UI 层的操作更新，以下是相关点：大体原理是通过记录所有变量的当前值，然后当发生特定的操作之后，angularJS 会调用 <code>$digest</code> 方法，这个方法内部做的逻辑就是遍历所有的 <code>watcher(观察者)</code>，对被监控的属性做对比，对比其在方法调用前后属性值有没有发生变化，如果发生变化，则调用对应的 <code>handler</code> (处理函数)。</p>
<h3 id="触发脏检测的操作"><a href="#触发脏检测的操作" class="headerlink" title="触发脏检测的操作"></a>触发脏检测的操作</h3><ul>
<li>DOM事件，譬如用户输入文本，点击按钮(ng-click)等</li>
<li>XHR响应事件 ($http)</li>
<li>浏览器Location变更事件 ($location)</li>
<li>Timer事件($timeout, $interval)</li>
<li>执行 $digest() 或 $apply()</li>
</ul>
<p>如果大家感兴趣 angularJS 双向数据绑定的具体实现，可以阅读下面的一些文章：</p>
<ul>
<li><a href="http://www.html-js.com/article/2145" target="_blank" rel="noopener">AngularJS数据双向绑定揭秘</a></li>
<li><a href="https://www.zhihu.com/question/23275373" target="_blank" rel="noopener">AngularJS的数据双向绑定是怎么实现的？</a></li>
</ul>
<p><em>脏检测方式的缺点十分明显，就是<strong>遍历 watcher 是很消耗性能</strong>的，特别是当监控数量达到一个数量级的时候。</em></p>
<h2 id="数据劫持-Hijacking-实现"><a href="#数据劫持-Hijacking-实现" class="headerlink" title="数据劫持(Hijacking)实现"></a>数据劫持(Hijacking)实现</h2><p>事实上，目前许多 MVVM 框架（vue.js、avalon.js 等）都是使用这种技术实现，数据劫持的核心是通过 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener">Object.defineProperty()</a>来实现。我们可以使用 <code>Object.defineProperty()</code> 来定义一个对象的属性情况，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object.defineProperty(obj, key,&#123;</span><br><span class="line">    value: someValue ,</span><br><span class="line">    writable: true, // 可写</span><br><span class="line">    enumerable: true, // 可被赋值</span><br><span class="line">    configurable: true // 可改变和删除</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>除了上面之外，我们还可以设置属性的 <code>getter</code>，<code>setter</code>。当存在 <code>getter</code>，<code>setter</code> 函数时，会出现下面的情况：</p>
<ul>
<li>当获取目标属性时触发 <code>getter</code> 函数的执行</li>
<li>当对目标属性进行赋值操作时会触发 <code>setter</code>函数的执行</li>
</ul>
<p>根据我们行业的术语，这种方式称为 <strong>数据劫持</strong>。通过使用 <strong>数据劫持</strong>，我们可以这样实现双向绑定：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// 定义一个设置属性 setter 和 getter 的方法</span><br><span class="line">function defineProperty(obj, attr, value)&#123;</span><br><span class="line">  // 私有变量 value</span><br><span class="line">  var value;</span><br><span class="line"></span><br><span class="line">  Object.defineProperty(obj, attr, &#123;</span><br><span class="line">    get:function ()&#123;</span><br><span class="line">      console.log(&apos;获取属性值&apos; + value);</span><br><span class="line">      return value;</span><br><span class="line">    &#125;,</span><br><span class="line">    set:function (val)&#123;</span><br><span class="line">      console.log(&apos;修改属性值为 &apos; + value); </span><br><span class="line">      value = val;</span><br><span class="line">      console.log(&apos;修改属性值&apos;); </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  // 设置属性值</span><br><span class="line">  obj[attr] = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 通过使用 defineProperty 方法，设置 man 的 name 属性的数据变化监听</span><br><span class="line">var man = &#123;&#125;;</span><br><span class="line">defineProperty(man, &apos;name&apos;, &quot;cover&quot;); // 修改属性值为 cover</span><br><span class="line">man.name; // 获取属性值 cover</span><br><span class="line">man.name = &apos;kevin&apos;; // 修改属性值为 kevin</span><br></pre></td></tr></table></figure>
<p>通过 <code>Object.defineProperty()</code> ，我们可以轻松地得知数据（对象）发生变化，然后在相应的 <code>setter</code> 函数中设置数据更新相应的操作（如发布更新事件）。通过这种方式我们可以使用赋值操作 <code>=</code> 来实现数据绑定，相对前面通过手动调用绑定指定更新数据接口 <code>updateData</code> 来说更加优雅。</p>
<p><em>注：比较主流的方法，针对部分还不支持 <code>Object.defineProperty</code> 低级浏览器，可采用 <code>VBScript</code> 作了完美兼容。当然大部分 mvvm 框架已经逐渐放弃对低端浏览器的支持。</em></p>
<h2 id="更多阅读-1"><a href="#更多阅读-1" class="headerlink" title="更多阅读"></a>更多阅读</h2><ul>
<li><a href="http://jixianqianduan.com/frontend-javascript/2015/11/29/js-data-two-ways-binding.html" target="_blank" rel="noopener">javascript实现数据双向绑定的三种方式</a></li>
<li><a href="https://div.io/topic/600" target="_blank" rel="noopener">Object.observe()带来的数据绑定变革</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/28/前端知识归纳（7）-JS应用开发（part2-Ajax）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/28/前端知识归纳（7）-JS应用开发（part2-Ajax）/" itemprop="url">前端知识归纳（7）-- JS应用开发（part2 Ajax）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-28T10:20:22+08:00">
                2019-01-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/01/28/前端知识归纳（7）-JS应用开发（part2-Ajax）/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/01/28/前端知识归纳（7）-JS应用开发（part2-Ajax）/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  654
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h1><p>官网的第一句话：</p>
<blockquote>
<p><strong>JSON</strong> (JavaScript Object Notation) is a lightweight data-interchange format.</p>
</blockquote>
<p>JSON 是一种轻量级的数据交换格式。JSON 是一种格式，而不是对象，所以别再说“这个 JSON 对象有问题”这种话。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var a = &#123; // 这是一个对象字面量，和 JSON 无关</span><br><span class="line">    &quot;hello&quot;: &quot;JSON&quot;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var b = [ // 这是一个数组字面量，和 JSON 无关</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;hello&quot;: &quot;JSON&quot;</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">var c = &apos;&#123;&quot;hello&quot;:&quot;JSON&quot;&#125;&apos;; // 这是一个字符串变量，和 JSON 有一点关系</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;hello&quot;:&quot;JSON&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>这才是 JSON ，JSON 就是文本，和什么语言没有关系，JS 可以解析，自然 JAVA、Python 都可以解析，所以<code>{&quot;hello&quot;:function () {}}</code>不是一个 JSON 是不是就很容易理解了，你这个 <code>function</code>放在 JAVA 里面算个什么回事？！</p>
<p>当然，它是有格式的文本，至于什么格式，看官网 <a href="http://json.org/" target="_blank" rel="noopener">http://json.org/</a> 就好了。</p>
<h1 id="jqXHR"><a href="#jqXHR" class="headerlink" title="jqXHR"></a>jqXHR</h1><p><strong>jqXHR</strong> 是一个对象，是 jQuery 中的 XHR 的对象，影响了一代人。</p>
<p>你辛辛苦苦的写了下面这个代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var xhr = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange = () =&gt; &#123;</span><br><span class="line">    if (xhr.readyState === 4) &#123;</span><br><span class="line">        // todo</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.log(xhr.status);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xhr.open(&apos;get&apos;, &apos;data.json&apos;);</span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>
<p>使用 jQuery 只用这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.getJSON(&apos;data.json&apos;, function() &#123;</span><br><span class="line">    // todo</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>我想没人不喜欢这样写吧，具体可以参考 <a href="http://api.jquery.com/jquery.getjson/" target="_blank" rel="noopener">http://api.jquery.com/jquery.getjson/</a> 。所以很多人认为 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API" target="_blank" rel="noopener">Fetch</a> 的出现就是受到 jQuery 的影响。</p>
<p><code>$.getJSON</code> 是一个简写，jQuery 的 ajax 有更底层的接口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    dataType: &apos;json&apos;,</span><br><span class="line">   url: &apos;data.json&apos;,</span><br><span class="line">   success: function() &#123;</span><br><span class="line">        // todo</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>别忘了我们的题目是 jqXHR ，所以接口什么的不多说，更详细的介绍可以参考这里：<a href="http://api.jquery.com/jQuery.ajax/" target="_blank" rel="noopener">http://api.jquery.com/jQuery.ajax/</a> 。</p>
<p>给上面的代码赋个值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const jqXHR = $.ajax(&#123;</span><br><span class="line">    dataType: &apos;json&apos;,</span><br><span class="line">   url: &apos;data.json&apos;,</span><br><span class="line">   success: function() &#123;</span><br><span class="line">        // todo</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>没错，所有的 jQuery ajax 返回值，不管是 <code>ajax()</code> 底层还是 <code>getJSON()</code> 高阶，都是返回 jqXHR 对象。</p>
<p>jqXHR 是原生 XHR 的封装，原生有的它都有，原生没有的，它也有。</p>
<blockquote>
<p>The jqXHR objects returned by <code>$.ajax()</code> as of jQuery 1.5 implement the Promise interface, giving them all the properties, methods, and behavior of a Promise.</p>
</blockquote>
<p>注意 <strong>Promise</strong> 字眼，Promise 是你们必须要掌握的东西，因为它是所有异步编程技术的基础，可以看看下面的参考资料。</p>
<p>而 Promise 带给 jqXHR 的变化，就是像下面这样写代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$.getJSON()</span><br><span class="line"> .done((data) =&gt; &#123; // todo &#125;)</span><br><span class="line">   .done((data) =&gt; &#123; // todo again &#125;)</span><br><span class="line">    .fail((err) =&gt; &#123; // if error &#125;)</span><br></pre></td></tr></table></figure>
<p>这就是为什么要聊聊 <strong>jqXHR</strong> 。</p>
<p>向 jQuery 致敬。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://www.gitbook.com/book/wohugb/promise/details" target="_blank" rel="noopener">JavaScript Promise迷你书（中文版）</a></li>
<li><a href="http://api.jquery.com/jQuery.ajax/#jqXHR" target="_blank" rel="noopener">http://api.jquery.com/jQuery.ajax/#jqXHR</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/28/前端知识归纳（7）-JS应用开发（part1-正则表达式）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sponge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sponge的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/28/前端知识归纳（7）-JS应用开发（part1-正则表达式）/" itemprop="url">前端知识归纳（7）-- JS应用开发（part1 正则表达式）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-28T09:40:49+08:00">
                2019-01-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/01/28/前端知识归纳（7）-JS应用开发（part1-正则表达式）/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/01/28/前端知识归纳（7）-JS应用开发（part1-正则表达式）/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  233
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><p><img src="/2019/01/28/前端知识归纳（7）-JS应用开发（part1-正则表达式）/regexp.png" alt="regexp.png"></p>
<h2 id="flags"><a href="#flags" class="headerlink" title="flags"></a>flags</h2><ul>
<li>i 忽略大小写</li>
<li>g 全局查找</li>
<li>m 多行查找<h2 id="量词"><a href="#量词" class="headerlink" title="量词"></a>量词</h2><img src="/2019/01/28/前端知识归纳（7）-JS应用开发（part1-正则表达式）/regexp-1.png" alt="regexp-1.png"></li>
</ul>
<h2 id="分组与捕获"><a href="#分组与捕获" class="headerlink" title="分组与捕获"></a>分组与捕获</h2><p><code>/(01){3}/</code>  ()代表分组<br>可以通过RexExp.exec()方法获取捕获的分组<br><code>/(?:01)/</code>非捕获型分组 即分组括号内加上?:</p>
<h2 id="引用和反向引用"><a href="#引用和反向引用" class="headerlink" title="引用和反向引用"></a>引用和反向引用</h2><p><code>var reg = /(01){3}/.exec(&#39;20010101&#39;);</code><br><code>reg[0]</code>或者<code>reg.$1</code> 代表引用</p>
<p><code>var reg = /&lt;(div)&gt;.*&lt;\/\1&gt;/</code><br><code>\1</code>反向引用</p>
<h2 id="惰性匹配"><a href="#惰性匹配" class="headerlink" title="惰性匹配"></a>惰性匹配</h2><p>贪婪匹配: 普通量词<br>惰性匹配: 普通量词加?<br>例：<code>/\d+?/</code></p>
<h2 id="正向前瞻和负向前瞻"><a href="#正向前瞻和负向前瞻" class="headerlink" title="正向前瞻和负向前瞻"></a>正向前瞻和负向前瞻</h2><p><code>/jero (?= love coding)/</code> 正向前瞻即分组括号内加?=<br><code>/jero (?! love girl)/</code> 负向前瞻即分组括号内加?!</p>
<p><code>/(?= love coding)/</code>  匹配位置<br><code>/(?! love girl)/</code></p>
<h2 id="String能使用正则的方法"><a href="#String能使用正则的方法" class="headerlink" title="String能使用正则的方法"></a>String能使用正则的方法</h2><ul>
<li>replace()</li>
<li>match()    与exec()区别，exec()捕获第一个符合分组条件的字符串，而match()则会将所有符合分组条件的子串都捕获出来</li>
<li>split()</li>
<li>search()</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener">RegExp | MDN</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Sponge</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sponge</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">65.6k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'JAytK8dtYmfQUns7Dd8iG9zC-gzGzoHsz',
        appKey: 'Y3ImYMhiFYr5d6sIuyK3ej0Q',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  

  
  

  

  

  

</body>
</html>
